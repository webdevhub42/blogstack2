{"expireTime":9007200911870449000,"key":"transformer-remark-markdown-ast-3eb271892b1c914fd07ec4d0084eb1a3-gatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"ðŸ’» PSQLðŸ’»","position":{"start":{"line":2,"column":3,"offset":4},"end":{"line":2,"column":12,"offset":13},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":12,"offset":13},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"source","position":{"start":{"line":4,"column":3,"offset":19},"end":{"line":4,"column":9,"offset":25},"indent":[]}}],"position":{"start":{"line":4,"column":3,"offset":19},"end":{"line":4,"column":9,"offset":25},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":17},"end":{"line":4,"column":9,"offset":25},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Basic Commands","position":{"start":{"line":6,"column":4,"offset":32},"end":{"line":6,"column":18,"offset":46},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":29},"end":{"line":6,"column":18,"offset":46},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Login to postgresql","position":{"start":{"line":8,"column":5,"offset":54},"end":{"line":8,"column":24,"offset":73},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":50},"end":{"line":8,"column":24,"offset":73},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">psql <span class=\"token operator\">-</span>U postgres\npsql <span class=\"token operator\">-</span>d mydb <span class=\"token operator\">-</span>U myuser <span class=\"token operator\">-</span>W\npsql <span class=\"token operator\">-</span>h myhost <span class=\"token operator\">-</span>d mydb <span class=\"token operator\">-</span>U myuser <span class=\"token operator\">-</span>W\npsql <span class=\"token operator\">-</span>U myuser <span class=\"token operator\">-</span>h myhost <span class=\"token string\">\"dbname=mydb sslmode=require\"</span> <span class=\"token comment\"># ssl connection</span></code></pre></div>","position":{"start":{"line":10,"column":1,"offset":77},"end":{"line":15,"column":4,"offset":243},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Default Admin Login","position":{"start":{"line":17,"column":5,"offset":251},"end":{"line":17,"column":24,"offset":270},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":247},"end":{"line":17,"column":24,"offset":270},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> -u postgres psql -U postgres\n<span class=\"token function\">sudo</span> -u postgres psql</code></pre></div>","position":{"start":{"line":19,"column":1,"offset":274},"end":{"line":22,"column":4,"offset":344},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"List databases on postgresql server","position":{"start":{"line":24,"column":5,"offset":352},"end":{"line":24,"column":40,"offset":387},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":348},"end":{"line":24,"column":40,"offset":387},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Determine system tables","position":{"start":{"line":26,"column":5,"offset":395},"end":{"line":26,"column":28,"offset":418},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":391},"end":{"line":26,"column":28,"offset":418},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">select</span> * from pg_tables where tableowner <span class=\"token operator\">=</span> <span class=\"token string\">'postgres'</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":28,"column":1,"offset":422},"end":{"line":30,"column":4,"offset":490},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"List databases from within a pg shell","position":{"start":{"line":32,"column":5,"offset":498},"end":{"line":32,"column":42,"offset":535},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":494},"end":{"line":32,"column":42,"offset":535},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"List databases from UNIX command prompt","position":{"start":{"line":34,"column":5,"offset":543},"end":{"line":34,"column":44,"offset":582},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":539},"end":{"line":34,"column":44,"offset":582},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Describe a table","position":{"start":{"line":36,"column":5,"offset":590},"end":{"line":36,"column":21,"offset":606},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":586},"end":{"line":36,"column":21,"offset":606},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Quit psql","position":{"start":{"line":38,"column":5,"offset":614},"end":{"line":38,"column":14,"offset":623},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":610},"end":{"line":38,"column":14,"offset":623},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Switch postgres database within admin login shell","position":{"start":{"line":40,"column":5,"offset":631},"end":{"line":40,"column":54,"offset":680},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":627},"end":{"line":40,"column":54,"offset":680},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Reset a user password as admin","position":{"start":{"line":42,"column":5,"offset":688},"end":{"line":42,"column":35,"offset":718},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":684},"end":{"line":42,"column":35,"offset":718},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">alter user usertochange with password <span class=\"token string\">'new_passwd'</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":44,"column":1,"offset":722},"end":{"line":46,"column":4,"offset":787},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Show all tables","position":{"start":{"line":48,"column":5,"offset":795},"end":{"line":48,"column":20,"offset":810},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":791},"end":{"line":48,"column":20,"offset":810},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"List all Schemas","position":{"start":{"line":50,"column":5,"offset":818},"end":{"line":50,"column":21,"offset":834},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":814},"end":{"line":50,"column":21,"offset":834},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"List all users","position":{"start":{"line":52,"column":5,"offset":842},"end":{"line":52,"column":19,"offset":856},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":838},"end":{"line":52,"column":19,"offset":856},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Load data into postgresql","position":{"start":{"line":54,"column":5,"offset":864},"end":{"line":54,"column":30,"offset":889},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":860},"end":{"line":54,"column":30,"offset":889},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">psql -W -U username -H <span class=\"token function\">hostname</span> <span class=\"token operator\">&lt;</span> file.sql</code></pre></div>","position":{"start":{"line":56,"column":1,"offset":893},"end":{"line":58,"column":4,"offset":949},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Dump (Backup) Data into file","position":{"start":{"line":60,"column":5,"offset":957},"end":{"line":60,"column":33,"offset":985},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":953},"end":{"line":60,"column":33,"offset":985},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pg_dump -W -U username -h <span class=\"token function\">hostname</span> database_name <span class=\"token operator\">></span> file.sql</code></pre></div>","position":{"start":{"line":62,"column":1,"offset":989},"end":{"line":64,"column":4,"offset":1062},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Increment a sequence","position":{"start":{"line":66,"column":5,"offset":1070},"end":{"line":66,"column":25,"offset":1090},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":1066},"end":{"line":66,"column":25,"offset":1090},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">SELECT nextval<span class=\"token punctuation\">(</span><span class=\"token string\">'my_id_seq'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":68,"column":1,"offset":1094},"end":{"line":70,"column":4,"offset":1136},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Create new user","position":{"start":{"line":72,"column":5,"offset":1144},"end":{"line":72,"column":20,"offset":1159},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":1140},"end":{"line":72,"column":20,"offset":1159},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">CREATE <span class=\"token environment constant\">USER</span> lemmy WITH PASSWORD <span class=\"token string\">'myPassword'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># or</span>\n\n<span class=\"token function\">sudo</span> -u postgres createuser lemmy -W</code></pre></div>","position":{"start":{"line":74,"column":1,"offset":1163},"end":{"line":79,"column":4,"offset":1268},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Change user password","position":{"start":{"line":81,"column":5,"offset":1276},"end":{"line":81,"column":25,"offset":1296},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":1272},"end":{"line":81,"column":25,"offset":1296},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ALTER <span class=\"token environment constant\">USER</span> Postgres WITH PASSWORD <span class=\"token string\">'mypass'</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":83,"column":1,"offset":1300},"end":{"line":85,"column":4,"offset":1357},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Grant user createdb privilege","position":{"start":{"line":87,"column":5,"offset":1365},"end":{"line":87,"column":34,"offset":1394},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":1361},"end":{"line":87,"column":34,"offset":1394},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ALTER <span class=\"token environment constant\">USER</span> myuser WITH createdb<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":89,"column":1,"offset":1398},"end":{"line":91,"column":4,"offset":1444},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Create a superuser user","position":{"start":{"line":93,"column":5,"offset":1452},"end":{"line":93,"column":28,"offset":1475},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":1448},"end":{"line":93,"column":28,"offset":1475},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">create user mysuper with password <span class=\"token string\">'1234'</span> SUPERUSER\n<span class=\"token comment\"># or even better</span>\ncreate user mysuper with password <span class=\"token string\">'1234'</span> SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN REPLICATION<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># or</span>\n<span class=\"token function\">sudo</span> -u postgres createuser lemmy -W -s</code></pre></div>","position":{"start":{"line":95,"column":1,"offset":1479},"end":{"line":101,"column":4,"offset":1707},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Upgrade an existing user to superuser","position":{"start":{"line":103,"column":5,"offset":1715},"end":{"line":103,"column":42,"offset":1752},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":1711},"end":{"line":103,"column":42,"offset":1752},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">alter user mysuper with superuser<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># or even better</span>\nalter user mysuper with SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN REPLICATION</code></pre></div>","position":{"start":{"line":105,"column":1,"offset":1756},"end":{"line":109,"column":4,"offset":1903},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Show Database Version","position":{"start":{"line":111,"column":5,"offset":1911},"end":{"line":111,"column":26,"offset":1932},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":1907},"end":{"line":111,"column":26,"offset":1932},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Change Database Owner","position":{"start":{"line":113,"column":5,"offset":1940},"end":{"line":113,"column":26,"offset":1961},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":1936},"end":{"line":113,"column":26,"offset":1961},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">alter database database_name owner to new_owner<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":115,"column":1,"offset":1965},"end":{"line":117,"column":4,"offset":2027},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Copy a database","position":{"start":{"line":119,"column":5,"offset":2035},"end":{"line":119,"column":20,"offset":2050},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":2031},"end":{"line":119,"column":20,"offset":2050},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">CREATE DATABASE newdb WITH TEMPLATE originaldb<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":121,"column":1,"offset":2054},"end":{"line":123,"column":4,"offset":2115},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"View Database Connections","position":{"start":{"line":125,"column":5,"offset":2123},"end":{"line":125,"column":30,"offset":2148},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":2119},"end":{"line":125,"column":30,"offset":2148},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">SELECT * FROM pg_stat_activity<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":127,"column":1,"offset":2152},"end":{"line":129,"column":4,"offset":2197},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"View show data directory (works on 9.1+)","position":{"start":{"line":131,"column":5,"offset":2205},"end":{"line":131,"column":45,"offset":2245},"indent":[]}}],"position":{"start":{"line":131,"column":1,"offset":2201},"end":{"line":131,"column":45,"offset":2245},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Show run-time parameters","position":{"start":{"line":133,"column":5,"offset":2253},"end":{"line":133,"column":29,"offset":2277},"indent":[]}}],"position":{"start":{"line":133,"column":1,"offset":2249},"end":{"line":133,"column":29,"offset":2277},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">show all<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> * from pg_settings<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":135,"column":1,"offset":2281},"end":{"line":138,"column":4,"offset":2332},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Show the block size setting","position":{"start":{"line":140,"column":5,"offset":2340},"end":{"line":140,"column":32,"offset":2367},"indent":[]}}],"position":{"start":{"line":140,"column":1,"offset":2336},"end":{"line":140,"column":32,"offset":2367},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># show block_size;</span>\n block_size\n------------\n <span class=\"token number\">8192</span>\n<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> row<span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":142,"column":1,"offset":2371},"end":{"line":148,"column":4,"offset":2446},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Show stored procedure source","position":{"start":{"line":150,"column":5,"offset":2454},"end":{"line":150,"column":33,"offset":2482},"indent":[]}}],"position":{"start":{"line":150,"column":1,"offset":2450},"end":{"line":150,"column":33,"offset":2482},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">SELECT prosrc FROM pg_proc WHERE proname <span class=\"token operator\">=</span> <span class=\"token string\">'procname'</span></code></pre></div>","position":{"start":{"line":152,"column":1,"offset":2486},"end":{"line":154,"column":4,"offset":2553},"indent":[1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Grant examples","position":{"start":{"line":156,"column":5,"offset":2561},"end":{"line":156,"column":19,"offset":2575},"indent":[]}}],"position":{"start":{"line":156,"column":1,"offset":2557},"end":{"line":156,"column":19,"offset":2575},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># readonly to all tables for myuser</span>\n<span class=\"token keyword\">grant</span> <span class=\"token keyword\">select</span> <span class=\"token keyword\">on</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">tables</span> <span class=\"token operator\">in</span> <span class=\"token keyword\">schema</span> <span class=\"token keyword\">public</span> <span class=\"token keyword\">to</span> myuser<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># all privileges on table1 and table2 to myuser</span>\n<span class=\"token keyword\">grant</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">privileges</span> <span class=\"token keyword\">on</span> table1<span class=\"token punctuation\">,</span> table2<span class=\"token punctuation\">,</span> table3 <span class=\"token keyword\">to</span> myuser<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":158,"column":1,"offset":2579},"end":{"line":163,"column":4,"offset":2791},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Restore Postgres .dump file","position":{"start":{"line":165,"column":5,"offset":2799},"end":{"line":165,"column":32,"offset":2826},"indent":[]}}],"position":{"start":{"line":165,"column":1,"offset":2795},"end":{"line":165,"column":32,"offset":2826},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">pg_restore <span class=\"token comment\">--verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump</span></code></pre></div>","position":{"start":{"line":167,"column":1,"offset":2830},"end":{"line":169,"column":4,"offset":2934},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://gist.github.com/kagemusha/1569836","children":[{"type":"text","value":"source","position":{"start":{"line":171,"column":2,"offset":2939},"end":{"line":171,"column":8,"offset":2945},"indent":[]}}],"position":{"start":{"line":171,"column":1,"offset":2938},"end":{"line":171,"column":52,"offset":2989},"indent":[]}}],"position":{"start":{"line":171,"column":1,"offset":2938},"end":{"line":171,"column":52,"offset":2989},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Find all active sessions and kill them (i.e. for when needing to drop or rename db)","position":{"start":{"line":173,"column":5,"offset":2997},"end":{"line":173,"column":88,"offset":3080},"indent":[]}}],"position":{"start":{"line":173,"column":1,"offset":2993},"end":{"line":173,"column":88,"offset":3080},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Source: ","position":{"start":{"line":175,"column":1,"offset":3084},"end":{"line":175,"column":9,"offset":3092},"indent":[]}},{"type":"link","title":null,"url":"http://stackoverflow.com/questions/5408156/how-to-drop-a-postgresql-database-if-there-are-active-connections-to-it","children":[{"type":"text","value":"http://stackoverflow.com/questions/5408156/how-to-drop-a-postgresql-database-if-there-are-active-connections-to-it","position":{"start":{"line":175,"column":10,"offset":3093},"end":{"line":175,"column":124,"offset":3207},"indent":[]}}],"position":{"start":{"line":175,"column":9,"offset":3092},"end":{"line":175,"column":125,"offset":3208},"indent":[]}}],"position":{"start":{"line":175,"column":1,"offset":3084},"end":{"line":175,"column":125,"offset":3208},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># Postgres 9.6 and above</span>\n<span class=\"token keyword\">SELECT</span> pg_terminate_backend<span class=\"token punctuation\">(</span>pg_stat_activity<span class=\"token punctuation\">.</span>pid<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> pg_stat_activity\n<span class=\"token keyword\">WHERE</span> pg_stat_activity<span class=\"token punctuation\">.</span>datname <span class=\"token operator\">=</span> <span class=\"token string\">'TARGET_DB'</span>\n <span class=\"token operator\">AND</span> pid <span class=\"token operator\">&lt;></span> pg_backend_pid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># Postgres 9.6 and below</span>\n<span class=\"token keyword\">SELECT</span> pg_terminate_backend<span class=\"token punctuation\">(</span>pg_stat_activity<span class=\"token punctuation\">.</span>procpid<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">FROM</span> pg_stat_activity\n<span class=\"token keyword\">WHERE</span> pg_stat_activity<span class=\"token punctuation\">.</span>datname <span class=\"token operator\">=</span> <span class=\"token string\">'TARGET_DB'</span>\n<span class=\"token operator\">AND</span> procpid <span class=\"token operator\">&lt;></span> pg_backend_pid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":177,"column":1,"offset":3212},"end":{"line":189,"column":4,"offset":3586},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Handy Queries","position":{"start":{"line":191,"column":4,"offset":3593},"end":{"line":191,"column":17,"offset":3606},"indent":[]}}],"position":{"start":{"line":191,"column":1,"offset":3590},"end":{"line":191,"column":17,"offset":3606},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- List procedure/function</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> pg_proc <span class=\"token keyword\">WHERE</span> proname<span class=\"token operator\">=</span><span class=\"token string\">'__procedurename__'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- List view (including the definition)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> pg_views <span class=\"token keyword\">WHERE</span> viewname<span class=\"token operator\">=</span><span class=\"token string\">'__viewname__'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Show DB table space in use</span>\n<span class=\"token keyword\">SELECT</span> pg_size_pretty<span class=\"token punctuation\">(</span>pg_total_relation_size<span class=\"token punctuation\">(</span><span class=\"token string\">'__table_name__'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>:\n\n<span class=\"token comment\">-- Show DB space in use</span>\n<span class=\"token keyword\">SELECT</span> pg_size_pretty<span class=\"token punctuation\">(</span>pg_database_size<span class=\"token punctuation\">(</span><span class=\"token string\">'__database_name__'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Show current user's statement timeout</span>\n<span class=\"token keyword\">show</span> statement_timeout<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Show table indexes</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> pg_indexes <span class=\"token keyword\">WHERE</span> tablename<span class=\"token operator\">=</span><span class=\"token string\">'__table_name__'</span> <span class=\"token operator\">AND</span> schemaname<span class=\"token operator\">=</span><span class=\"token string\">'__schema_name__'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Get all indexes from all tables of a schema:</span>\n<span class=\"token keyword\">SELECT</span>\n   t<span class=\"token punctuation\">.</span>relname <span class=\"token keyword\">AS</span> table_name<span class=\"token punctuation\">,</span>\n   i<span class=\"token punctuation\">.</span>relname <span class=\"token keyword\">AS</span> index_name<span class=\"token punctuation\">,</span>\n   a<span class=\"token punctuation\">.</span>attname <span class=\"token keyword\">AS</span> column_name\n<span class=\"token keyword\">FROM</span>\n   pg_class t<span class=\"token punctuation\">,</span>\n   pg_class i<span class=\"token punctuation\">,</span>\n   pg_index ix<span class=\"token punctuation\">,</span>\n   pg_attribute a<span class=\"token punctuation\">,</span>\n   pg_namespace n\n<span class=\"token keyword\">WHERE</span>\n   t<span class=\"token punctuation\">.</span>oid <span class=\"token operator\">=</span> ix<span class=\"token punctuation\">.</span>indrelid\n   <span class=\"token operator\">AND</span> i<span class=\"token punctuation\">.</span>oid <span class=\"token operator\">=</span> ix<span class=\"token punctuation\">.</span>indexrelid\n   <span class=\"token operator\">AND</span> a<span class=\"token punctuation\">.</span>attrelid <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>oid\n   <span class=\"token operator\">AND</span> a<span class=\"token punctuation\">.</span>attnum <span class=\"token operator\">=</span> <span class=\"token keyword\">ANY</span><span class=\"token punctuation\">(</span>ix<span class=\"token punctuation\">.</span>indkey<span class=\"token punctuation\">)</span>\n   <span class=\"token operator\">AND</span> t<span class=\"token punctuation\">.</span>relnamespace <span class=\"token operator\">=</span> n<span class=\"token punctuation\">.</span>oid\n   <span class=\"token operator\">AND</span> n<span class=\"token punctuation\">.</span>nspname <span class=\"token operator\">=</span> <span class=\"token string\">'kartones'</span>\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span>\n   t<span class=\"token punctuation\">.</span>relname<span class=\"token punctuation\">,</span>\n   i<span class=\"token punctuation\">.</span>relname\n\n<span class=\"token comment\">-- Queries being executed at a certain DB</span>\n<span class=\"token keyword\">SELECT</span> datname<span class=\"token punctuation\">,</span> application_name<span class=\"token punctuation\">,</span> pid<span class=\"token punctuation\">,</span> backend_start<span class=\"token punctuation\">,</span> query_start<span class=\"token punctuation\">,</span> state_change<span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">,</span> query\n  <span class=\"token keyword\">FROM</span> pg_stat_activity\n  <span class=\"token keyword\">WHERE</span> datname<span class=\"token operator\">=</span><span class=\"token string\">'__database_name__'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Get all queries from all dbs waiting for data (might be hung)</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> pg_stat_activity <span class=\"token keyword\">WHERE</span> waiting<span class=\"token operator\">=</span><span class=\"token string\">'t'</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":193,"column":1,"offset":3610},"end":{"line":241,"column":4,"offset":4967},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Query analysis","position":{"start":{"line":243,"column":5,"offset":4975},"end":{"line":243,"column":19,"offset":4989},"indent":[]}}],"position":{"start":{"line":243,"column":1,"offset":4971},"end":{"line":243,"column":19,"offset":4989},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">-- See the query plan <span class=\"token keyword\">for</span> the given query\nEXPLAIN __query__\n\n-- See and execute the query plan <span class=\"token keyword\">for</span> the given query\nEXPLAIN ANALYZE __query__\n\n-- Collect statistics\nANALYZE <span class=\"token punctuation\">[</span>__table__<span class=\"token punctuation\">]</span></code></pre></div>","position":{"start":{"line":245,"column":1,"offset":4993},"end":{"line":254,"column":4,"offset":5197},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Querying Data","position":{"start":{"line":256,"column":4,"offset":5204},"end":{"line":256,"column":17,"offset":5217},"indent":[]}}],"position":{"start":{"line":256,"column":1,"offset":5201},"end":{"line":256,"column":17,"offset":5217},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"From a Single Table","position":{"start":{"line":258,"column":5,"offset":5225},"end":{"line":258,"column":24,"offset":5244},"indent":[]}}],"position":{"start":{"line":258,"column":1,"offset":5221},"end":{"line":258,"column":24,"offset":5244},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">-- Query data <span class=\"token keyword\">in</span> columns c1, c2 from a table\nSELECT c1, c2 FROM t<span class=\"token punctuation\">;</span>\n\n-- Query distinct rows from a table\nSELECT DISTINCT c1\nFROM t\nWHERE condition<span class=\"token punctuation\">;</span>\n\n-- Sort the result <span class=\"token builtin class-name\">set</span> <span class=\"token keyword\">in</span> ascending or descending order\nSELECT c1, c2\nFROM t\nORDER BY c1 ASC <span class=\"token punctuation\">[</span>DESC<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n-- Skip offset of rows and <span class=\"token builtin class-name\">return</span> the next n rows\nSELECT c1, c2\nFROM t\nORDER BY c1\nLIMIT n\nOFFSET offset<span class=\"token punctuation\">;</span>\n\n-- Group rows using an aggregate <span class=\"token keyword\">function</span>\nSELECT c1, aggregate<span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">)</span>\nFROM t\nGROUP BY c1<span class=\"token punctuation\">;</span>\n\n-- Filter <span class=\"token function\">groups</span> using HAVING clause\nSELECT c1, aggregate<span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">)</span> FROM t\nGROUP BY c1\nHAVING condition<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":260,"column":1,"offset":5248},"end":{"line":290,"column":4,"offset":5833},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"From Multiple Tables","position":{"start":{"line":292,"column":5,"offset":5841},"end":{"line":292,"column":25,"offset":5861},"indent":[]}}],"position":{"start":{"line":292,"column":1,"offset":5837},"end":{"line":292,"column":25,"offset":5861},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Inner join t1 and t2</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> t2\n<span class=\"token keyword\">ON</span> condition<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Left join t1 and t1</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> t2\n<span class=\"token keyword\">ON</span> condition<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Right join t1 and t2</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">RIGHT</span> <span class=\"token keyword\">JOIN</span> t2\n<span class=\"token keyword\">ON</span> condition<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Perform full outer join</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">FULL</span> <span class=\"token keyword\">OUTER</span> <span class=\"token keyword\">JOIN</span> t2\n<span class=\"token keyword\">ON</span> condition<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Produce a Cartesian product of rows in tables</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">CROSS</span> <span class=\"token keyword\">JOIN</span> t2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Another way to perform cross join</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Join t1 to itself using INNER JOIN clause</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t1 A\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> t2 B <span class=\"token keyword\">ON</span> condition</code></pre></div>","position":{"start":{"line":294,"column":1,"offset":5865},"end":{"line":332,"column":4,"offset":6469},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Using SQL Operators","position":{"start":{"line":334,"column":5,"offset":6477},"end":{"line":334,"column":24,"offset":6496},"indent":[]}}],"position":{"start":{"line":334,"column":1,"offset":6473},"end":{"line":334,"column":24,"offset":6496},"indent":[]}},{"type":"html","lang":"sql","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Combine rows from two queries</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">UNION</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">ALL</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Return the intersection of two queries</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">INTERSECT</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Subtract a result set from another result set</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">EXCEPT</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t2<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Query rows using pattern matching %, _</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t1\n<span class=\"token keyword\">WHERE</span> c1 <span class=\"token punctuation\">[</span><span class=\"token operator\">NOT</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">LIKE</span> pattern<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Query rows in a list</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t\n<span class=\"token keyword\">WHERE</span> c1\n<span class=\"token punctuation\">[</span><span class=\"token operator\">NOT</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">IN</span> value_list<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Query rows between two values</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2\n<span class=\"token keyword\">FROM</span> t\n<span class=\"token keyword\">WHERE</span> c1\n<span class=\"token operator\">BETWEEN</span> low <span class=\"token operator\">AND</span> high<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- Check if values in a table is NULL or not</span>\n<span class=\"token keyword\">SELECT</span> c1<span class=\"token punctuation\">,</span> c2 <span class=\"token keyword\">FROM</span> t\n<span class=\"token keyword\">WHERE</span> c1 <span class=\"token operator\">IS</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">NOT</span><span class=\"token punctuation\">]</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":336,"column":1,"offset":6500},"end":{"line":371,"column":4,"offset":7182},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Source","position":{"start":{"line":373,"column":4,"offset":7189},"end":{"line":373,"column":10,"offset":7195},"indent":[]}}],"position":{"start":{"line":373,"column":1,"offset":7186},"end":{"line":373,"column":10,"offset":7195},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://www.postgresql.org/docs/9.6/static/app-psql.html","children":[{"type":"text","value":"PostgreSQL 9.6.0 Documentation","position":{"start":{"line":375,"column":4,"offset":7202},"end":{"line":375,"column":34,"offset":7232},"indent":[]}}],"position":{"start":{"line":375,"column":3,"offset":7201},"end":{"line":375,"column":93,"offset":7291},"indent":[]}}],"position":{"start":{"line":375,"column":3,"offset":7201},"end":{"line":375,"column":93,"offset":7291},"indent":[]}}],"position":{"start":{"line":375,"column":1,"offset":7199},"end":{"line":375,"column":93,"offset":7291},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://pgexercises.com","children":[{"type":"text","value":"PostgreSQL Exercises","position":{"start":{"line":376,"column":4,"offset":7296},"end":{"line":376,"column":24,"offset":7316},"indent":[]}}],"position":{"start":{"line":376,"column":3,"offset":7295},"end":{"line":376,"column":50,"offset":7342},"indent":[]}}],"position":{"start":{"line":376,"column":3,"offset":7295},"end":{"line":376,"column":50,"offset":7342},"indent":[]}}],"position":{"start":{"line":376,"column":1,"offset":7293},"end":{"line":376,"column":50,"offset":7342},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"http://www.postgresqltutorial.com/postgresql-cheat-sheets","children":[{"type":"text","value":"PostgreSQL Tutorial","position":{"start":{"line":377,"column":4,"offset":7347},"end":{"line":377,"column":23,"offset":7366},"indent":[]}}],"position":{"start":{"line":377,"column":3,"offset":7346},"end":{"line":377,"column":83,"offset":7426},"indent":[]}}],"position":{"start":{"line":377,"column":3,"offset":7346},"end":{"line":377,"column":83,"offset":7426},"indent":[]}}],"position":{"start":{"line":377,"column":1,"offset":7344},"end":{"line":377,"column":83,"offset":7426},"indent":[]}}],"position":{"start":{"line":375,"column":1,"offset":7199},"end":{"line":377,"column":83,"offset":7426},"indent":[1,1]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":378,"column":1,"offset":7428}}}}